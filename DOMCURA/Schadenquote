# 4) KPIs globaux (2020–2024)
# → Abschnitt zur Berechnung von globalen (aggregierten) Kennzahlen für die Jahre 2020–2024

ep_net <- sum(exposures$earned_premium_net, na.rm = TRUE)
# → Berechnet die gesamte verdiente Nettoprämie (earned premium net) über alle Verträge.
#   Die Funktion sum() summiert die Spalte 'earned_premium_net' aus dem Dataframe 'exposures'.
#   Argument na.rm = TRUE sorgt dafür, dass fehlende Werte (NA) ignoriert werden.

incurred <- sum(claims$paid, na.rm = TRUE) + sum(claims$reserve, na.rm = TRUE)
# → Berechnet die gesamten angefallenen Schäden (incurred losses):
#   Summe aus bereits gezahlten Schäden ('paid') und den gebildeten Schadenreserven ('reserve').
#   Beide Summen stammen aus dem Dataframe 'claims'; NA-Werte werden ignoriert.

lr <- ifelse(ep_net > 0, incurred / ep_net, NA_real_)
# → Berechnet die Loss Ratio (Schadenquote) = incurred losses / earned premium net.
#   ifelse() stellt sicher, dass nur berechnet wird, wenn die Prämie positiv ist.
#   Falls ep_net ≤ 0 oder fehlend, wird stattdessen NA (fehlender Wert) zurückgegeben.
#   NA_real_ spezifiziert, dass das Ergebnis vom Typ 'numeric (real)' ist.